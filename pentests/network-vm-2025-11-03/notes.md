# Notes & Commands (SANITIZED)

## Placeholders you MUST replace before running:
- 192.168.1.14    -> the VM IP address (e.g. 192.168.56.101)
- BASE            -> repository base folder (default: pentests/network-vm-2025-11-03)
  (If you use the repo root shown here, you can leave BASE as-is.)

---

## Reconnaissance
# Quick host discovery (adjust subnet to your lab)
nmap -sn 192.168.56.0/24

## Full TCP scan (save outputs)
$BASE$="pentests/network-vm-2025-11-03"    
mkdir -p "$BASE/nmap" "$BASE/tools-output"

# NOTE: replace $TARGET_IP$ below before running
sudo nmap -p- -sS -sV -T4 --min-rate 300 -oA "$BASE/nmap/nmap-full-TARGET" $TARGET_IP

## Focused HTTP enumeration for discovered ports (example)
nmap -p 80,38080 --script http-title,http-enum -oN "$BASE/tools-output/nmap-http-enum-TARGET.txt" $TARGET_IP

---

## HTTP Quick Checks
# Follow redirects and save headers
curl -I -L "http://192.168.1.14:38080" > "$BASE/tools-output/http-38080-headers-TARGET.txt"   

# Save the beginning of the response body (first 200 lines)
curl -s -L "http://192.168.1.14:38080" | sed -n '1,200p' > "$BASE/tools-output/http-38080-body-TARGET.txt"

---

## FTP (Anonymous)
# List anonymous FTP directory (lab-only)
lftp -u anonymous,anonymous -e "cls -l; bye" ftp://$TARGET_IP > "$BASE/tools-output/ftp-listing-TARGET.txt"

# If you need to download a file from FTP for private analysis:
# lftp -u anonymous,anonymous -e "get secret.txt -o /home/kali/private/secret.txt; bye" ftp://$TARGET_IP
# -> then encrypt the downloaded file before storing or sharing

---

## Web Content Discovery (Lab Only)
# Directory brute-forcing using a compact wordlist (start small)
gobuster dir -u "http://192.168.1.14:38080" -w /usr/share/wordlists/dirb/common.txt -o "$BASE/tools-output/gobuster-38080-TARGET.txt" -t 30

# nikto quick scan (non-destructive)
nikto -h "http://192.168.1.14:38080" -o "$BASE/tools-output/nikto-38080-TARGET.txt"

---

## Post-exploitation Enumeration (LAB ONLY)
# If you obtain an interactive shell, run linPEAS for local enumeration (only in lab)
# Example (on compromised host): wget a copy of linpeas, run it, but DO NOT commit raw output
# (store raw output encrypted offline and only include sanitized summaries in repo)

# Example commands to run inside a shell (ONLY in lab and with explicit authorization):
# wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
# chmod +x linpeas.sh
# ./linpeas.sh | tee /tmp/linpeas-raw.txt
# then move /tmp/linpeas-raw.txt to a safe place and encrypt it before leaving the host

---

## Saving and Sanitizing Outputs (recommended workflow)
# create sanitized copy of nmap output (replace real IPs first)
cp "$BASE/nmap/nmap-full-TARGET.nmap" "$BASE/nmap/nmap-full-TARGET-SANITIZED.nmap"

# replace any real IP addresses / hostnames in saved outputs before committing
# (example: replace 192.168.1.12 -> TARGET_IP)
sed -i "s/192\.168\.[0-9]\+\.[0-9]\+/TARGET_IP/g" "$BASE/tools-output"/* 2>/dev/null || true

# rename files that still contain concrete IPs in filename (optional)
for f in "$BASE"/tools-output/*192.168.*; do
  [ -e "$f" ] || continue
  mv -vn "$f" "$(echo "$f" | sed -E 's/192\.168\.[0-9]+\.[0-9]+/TARGET/g')"
done

# verify sanitized files
ls -la "$BASE/tools-output"

